# Adversarial Particle Swarm Optimization (APSO) Description

The given code is a Python script that implements the Adversarial Particle Swarm Optimization (APSO) algorithm. APSO aims to generate adversarial examples by optimizing a cost function using a particle swarm optimization algorithm.


## Global Variables
The code sets the following global variables:
- `label` to determine the target label for adversarial attacks.
- `initial` as the initial label of the dataset.
- `epochs` to specify the number of optimization epochs.
- `points` to define the number of attack points.

## Functions

### `cost_func(model, x)`
This function calculates the cost (prediction score) for a given input data point using a pre-trained PyTorch model. It takes the model and input data as arguments and returns the cost as a float.

### `umap_data(dataloader)`
This function generates UMAP embeddings for the data in a given dataloader. It takes a dataloader as input and returns the UMAP object fitted on the flattened data and a dictionary mapping target labels to their corresponding data points.

### `plotData(data, umap, title, saveName)`
This function plots the data points using UMAP embeddings. It takes the data, UMAP object, plot title, and save name as arguments.

### `plotPSO(points, step, model, runName)`
This function plots the Particle Swarm Optimization (PSO) results. It takes the list of points generated by the PSO algorithm, the current step or iteration number, the pre-trained PyTorch model, and the name of the PSO run as arguments.

### `getPositions(APSO)`
This function returns the positions of particles from an APSO object.

### `plotBest(APSO, model, runName, epoch)`
This function plots the best point and its activation map from APSO results. It takes the APSO object, pre-trained PyTorch model, name of the APSO run, and current epoch or iteration number as arguments.

### `runAPSO(points, epochs, model, cost_func, dataDic, umap, runName)`
This function runs the Adversarial Particle Swarm Optimization (APSO) algorithm. It takes the initial set of points, number of optimization epochs, pre-trained PyTorch model, cost function, dictionary of data points, UMAP object, and name of the APSO run as arguments. It returns the final positions of the particles after optimization.

### `main()`
This function is the main entry point of the script. It initializes global variables, loads the dataset, builds the model, and performs APSO for different attack scenarios. It calls the necessary functions to run APSO, plot clusters, and save results.

## Execution
The script starts by defining global variables and importing required libraries and modules. Then, it defines various functions for cost calculation, UMAP generation, plotting, and APSO optimization. Finally, the `main()` function is called to execute the script.
